{"ts":1378759158562,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\nrequire_once 'inc/standard.php';\n\n$page = new Page('scan', VOLUNTEER);\n$page->setTitle('Scan');\n$page->startGraph(); //adds the jQuery Sparkline to the header\n\n//check user login\nif(!$page->login->checkValidAccess($page, $_SERVER['PHP_SELF']))\n{\n\t$box = new Box('Access Denied', 'You do not have access to view this page');\n\t$page->setContent($box->display('half'));\n\t$page->buildPage();\n}\n\n//clean each $_POST value of dangerous inputs\n//example $newsettings['email'] = 'stburke@uci.edu';\nforeach ($_POST as $key => $value) {\n\t//echo '$newsettings[\\''.$key.'\\'] = '.$value.';<br>';\n\t$scan[$key] = trim(strip_tags($value));\n}\n\n$scan['barcode'] = trim(strip_tags($_GET['barcode']));\n\n//add the Event ID to the $scan array\nif($_GET['eid'])\n\t$scan['eid'] = trim(strip_tags($_GET['eid']));\nelseif($_COOKIE['eid'])\n\t$scan['eid'] = trim(strip_tags($_COOKIE['eid']));\n\t\n$ucinetid = ($_POST['ucinetid'])? $_POST['ucinetid']:$_GET['ucinetid'];\n\n/* make sure the slide animation does not trigger, \n * may confuse Volunteer who is scanning that a scan went through\n * when there was really an error.\n */\n$js_slide_down = false;\n\n$event = new Event($scan['eid']);\nsetcookie('eid', $scan['eid'], time() + (6*60*60)); //expires in 6 hours\nif(!$event->exists())\n{\n\t$page->setMessage('Please Select an Event Before Scanning', 'failure');\n\t$error_class_event_menu = 'error';\n}\n\nif($_GET['barcode'])\n{\n\t$barcode = new Barcode($scan['barcode']);\n\t$scanner = new Scanner();\n\t$errors = 1;\n\t\n\tif(!$event->exists())\n\t{\n\t\t$errors++;\n\t\t$error_message[$errors] = 'This event does not exist';\n\t\t$error_class_event_menu = 'error';\n\t}\n\t\n\tif(!$barcode->exists())\n\t{\n\t\t$errors++;\n\t\t$error_message[$errors] = 'The barcode <strong>#'.$barcode->code.'</strong> does not exist. Try scanning again.';\n\t\t$error_class_barcode = 'error';\n\t}\n\t\n\tif($scanner->exists($barcode->code, $scan['eid']))\n\t{\n\t\t$errors++;\n\t\t$form = '<form action=\"register.php\" method=\"GET\"><input type=\"text\" name=\"ucinetid\" placeholder=\"UCInetID\"><input type=\"submit\"></form>'; //todo associate barcode if the took one with out registering.\n\t\t$name = ($barcode->getName()) ? 'The user <strong>'.$barcode->getName().'</strong>':'The barcode <strong>#'.$barcode->code.'</strong>';\n\t\t$extra = ($barcode->getName()) ? 'Welcome.':'Please register this user\\'s UCInetID below: '.$form;\n\t\t$error_message[$errors] = $name.' has already been scanned. '.$extra;\n\t\t$error_class_barcode = 'error';\n\t}\n\t\t\n\tif($errors == 1)\n\t{\n\t\t$scanner->scan($barcode->code, $scan['eid'], $_SESSION['ucinetid']);\n\t\t$form = '<form action=\"register.php\" method=\"GET\"><input type=\"text\" name=\"ucinetid\" placeholder=\"UCInetID\"><input type=\"submit\"></form>'; //todo associate barcode if the took one with out registering.\n\t\t$name = ($barcode->getName()) ? 'The user <strong>'.$barcode->getName().'</strong>':'The barcode <strong>#'.$barcode->code.'</strong>';\n\t\t$extra = ($barcode->getName()) ? 'Welcome.':'Please register this user\\'s UCInetID below: '.$form;\n\t\t$message = $name.' has been scanned in'.$welcome;\n\t\t$page->setMessage($message, 'success');\n\t\t$js_slide_down = true;\n\t}\n\telse\n\t{\n\t\t$page->setMessage($error_message, 'failure');\n\t}\n}\n$sql = 'SELECT e.name, e.eid\n\t\tFROM events AS e\n\t\tORDER BY date ASC, time ASC';\n$page->DB->query($sql);\n\n$event_menu_array = $page->DB->resultToMakeArray('eid','name', 'Select Event');\n\n$event_menu = new DropMenu('eid', $event_menu_array, $scan['eid'], 'textarea');\n\n//echo 'time: '.strtotime($event->date.' '.$event->time).' > '. strtotime(NOW_DATE.' '.NOW_TIME);\nif($scan['eid'] != 0)\n{\n\tif(strtotime($event->date.' '.$event->time) > strtotime(NOW_DATE.' '.NOW_TIME))\n\t{\n\t\t\t\n\t\t$bottom .= ' <div class=\"row error\">\n\t\t\t\t\t\tEvent doesn\\'t start until '.date('h:i A', strtotime($event->time)).' on '.date('l, M d', strtotime($event->date)).'\n\t\t\t\t\t</div>';\n\t}\n\telseif((strtotime($event->date.' '.$event->time) + time(12*60*60)) < strtotime(NOW_DATE.' '.NOW_TIME))\n\t{\n\t\t$bottom .= '<div class=\"row error\">\n\t\t\t\t\t\tThis event is over.\n\t\t\t\t\t</div>';\n\t}\n\telseif(strtotime($event->date) == strtotime(NOW_DATE))\n\t{\n\t\t$bottom .= '<div class=\"row success\">\n\t\t\t\t\tThis event has started!\n\t\t\t\t</div>';\n\t}\n}\n$total_count = $page->DB->countOf('scans', 'eid = \"'.$_GET['eid'].'\"');\n\n$bottom .= ' \n\t\t<form id=\"select_event\" action=\"'.$_SERVER['PHP_SELF'].'\" method=\"GET\">\n\t\t\t<div class=\"row '.$error_class_event_menu.'\">\n\t\t\t\t<label for=\"eid\" class=\"fieldname\">Event</label>'\n\t\t\t\t.$event_menu->display().'\n\t\t\t</div>\n\t\t</form>\n\t\t<script>\n\t\t\t$(\"#eid\").change(function () {\n\t\t\t          $(\"#select_event\").submit();\n\t\t\t          });\n\t\t</script>';\n\t\tif($scan['eid'] != 0)\n\t\t{\n\t\t\n\t\t$bottom .= ' <div class=\"row\">\n\t\t\t<label class=\"fieldname\">Date</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.date('l, M d, Y',strtotime($event->date)).'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row\">\n\t\t\t<label class=\"fieldname\">Time</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.date('g:i a',strtotime($event->time)).'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row\">\n\t\t\t<label class=\"fieldname\">Host</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.$event->host.'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row\">\n\t\t\t<label class=\"fieldname\">Prize</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.$event->prize.'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row\">\n\t\t\t<label class=\"fieldname\">Description</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.$event->description.'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"row\">\n\t\t\t<label class=\"fieldname\">Total Participants</label>\n\t\t\t<div class=\"textarea\">\n\t\t\t'.$total_count.'\n\t\t\t</div>\n\t\t</div>';\n\t}\n\t$bottom .=\t' <div class=\" \">\n\t\t\t<div class=\"separator\"></div>\n\t\t\t<form action=\"'.$_SERVER['PHP_SELF'].'\" method=\"GET\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<label>Barcode</label>\n\t\t\t\t\t<input type=\"text\" name=\"barcode\" id=\"barcode\" class=\"textarea\">\n\t\t\t\t\t<input type=\"hidden\" name=\"eid\" value=\"'.$scan['eid'].'\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<input type=\"submit\" name=\"action\" value=\"Scan\" class=\"right\">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>';\n$limit = ($_GET['view'] == 'all') ? '':'LIMIT 5';\n\n$sql = 'SELECT scans.*, users.name, users.ucinetid, users.major, users.level\n\t\tFROM scans LEFT JOIN users\n\t\tON scans.barcode = users.barcode\n\t\tWHERE scans.eid = \"'.$scan['eid'].'\"\n\t\tORDER BY date DESC, time DESC\n\t\t'.$limit;\n\t\t\n$page->DB->query($sql);\n$ticker_array = $page->DB->resultToArray();\n$ticker_content .= '<div class=\"separator\"></div>';\n$ticker_content .= '<div class=\"row center\">\n\t\t\t\t\t\t<h3>Scan Ticker</h3>\n\t\t\t\t\t</div>';\n\t\t\t\t\t\n$ticker_content .= '<div class=\"list\">';\n\n/* Start doing the JavaScript \n *\n */\n \n//set initial javascript\nif($js_slide_down)\n\t$js_hide_row1 = '$(\"#row1\").hide();';\n$page->setJSInitial('$(\".dropdown\").hide(); '.$js_hide_row1);\n\t\n//set javascript after page is ready\n$ticker_content .= '<script>\n\t$(document).ready(function () {\n\t\t$(\"#barcode\").focus();';\nif($js_slide_down)\n $ticker_content .= '$(\"#row1\").slideDown();';\n\n$ticker_content .= '});</script>';\n\t\nif(count($ticker_array) > 0)\n{\n\t\n\tforeach ($ticker_array as $row)\n\t{\n\t\t$i++;\n\t\t\n\t\t$ticker_content .= '\n\t\t\t<div class=\"item\" id=\"row'.$i.'\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<label class=\"barcode\">Barcode: </span> #'.$row['barcode'].'</label>\n\t\t\t\t\t<span class=\"right\">'.$row['name'].'</span>\n\t\t\t\t\t<span class=\"date\">'.date('M j,', strtotime($row['date'])).'</span>\n\t\t\t\t\t<span class=\"time\">'.date('g:i:s A', strtotime($row['time'])).'</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"event_row\">\n\t\t\t\t<script>\n\t\t\t\t    $(\"#row'.$i.'\").click(function () {\n\t\t\t\t    \t$(\"#drop'.$i.'\").slideToggle(\"fast\");\n\t\t\t\t    });\n\t\t\t\t</script>\n\t\t\t\t<div class=\"dropdown\" id=\"drop'.$i.'\" style=\"display:none;\">\n\t\t\t\t\t<h5><strong>UCInetID:</strong> \t'.$row['ucinetid'].'</h5>\n\t\t\t\t\t<h5><strong>Name:</strong> \t\t'.$row['name'].'</h5>\n\t\t\t\t\t<h5><strong>Major:</strong> \t'.$row['major'].'</h5>\n\t\t\t\t\t<h5><strong>Level:</strong> \t'.$row['level'].'</h5>\n\t\t\t\t\t<h5><strong>Time:</strong>\t\t'.date('M j, Y,', strtotime($row['date'])).' '.date('g:i:s A', strtotime($row['time'])).'</h5>\n\t\t\t\t</div>\n\t\t\t</div>';\n\t}\n\t\n\t//view all link at the bottom of page\n\tif($_GET['view'] == 'all')\n\t{\n\t$ticker_content .= '\n\t\t<div class=\"row center\">\n\t\t<label id=\"view\"><a href=\"'.$_SERVER['PHP_SELF'].'?view=less#view\">View Less Scans</a></label>\n\t\t</div>';\n\t}\n\telse \n\t{\n\t$ticker_content .= '\n\t\t<div class=\"row center\">\n\t\t<label id=\"view\"><a href=\"'.$_SERVER['PHP_SELF'].'?view=all#view\">View All Scans</a></label>\n\t\t</div>';\n\t}\n}\nelse {\n\t$ticker_content .= '\n\t<div class=\"list\">\n\t<div class=\"row\">\n\t\t<label>No Scans Yet</label>\n\t</div>\n\t</div>';\n}\n$ticker_content .= '</div>';\n\n\n/*\n * \t\tstart Statistics display \n *\n *  \n */\n \n$box = new Box('Scanning for '.$event->name, $bottom.$ticker_content);\n$box->setBadge('Return to Events', 'events.php');\n$var_array = new VarArray();\n\n\nforeach ($var_array->getMajors() as $major) {\n\t$sql = 'SELECT *\n\t\t\tFROM scans\n\t\t\tLEFT JOIN users \n\t\t\tON scans.barcode = users.barcode\n\t\t\tWHERE scans.eid = \"'.$scan['eid'].'\"\n\t\t\tAND users.major = \"'.$major.'\"';\n\t$page->DB->query($sql);\n\t$temp = $page->DB->numRows();\n\t//echo '<br>value:'.$temp;\n\t\n\t$where .= 'major NOT LIKE \\''.$major.'\\' AND ';\n\tif($major != \"Other\")\n\t{\n\t\t$majors[$major] = $temp;\n\t}\n\telse\n\t{\n\t\t$where = substr($where, 0, strlen($where)-5);\n\t\t$sql = 'SELECT COUNT(*)\n\t\t\t\tFROM scans\n\t\t\t\tLEFT JOIN users \n\t\t\t\tON scans.barcode = users.barcode\n\t\t\t\tWHERE scans.eid = \"'.$scan['eid'].'\"\n\t\t\t\tAND '.$where;\n\t\t//echo \"where: \".$where;\n\t\t//$majors[\"other\"] = $page->DB->countOf('users', $where_majors_not_like, 1);\n\t\t$majors[\"Other\"] = $page->DB->queryUniqueValue($sql);\n\t}\n\t\n}\n\n$majors_stat = new Statistic('pie', 'user_majors', 'Registered Users - Major', $majors, 0);\n\n$bottom_stats = $majors_stat->display();\n\nif($scan['eid'] != 0)\n{\n$box_stat = new Box('Statistics', $bottom_stats);\n$stat_display = '<div class=\"separator\"></div>'.$box_stat->display(\"full\");\n}\n$content = $box->display().$stat_display;\n\n$page->setContent($content);\n$page->buildPage();\n?>"]],"start1":0,"start2":0,"length1":0,"length2":9831}]],"length":9831}
{"contributors":[],"silentsave":false,"ts":1378765850318,"patch":[[{"diffs":[[0,"\n}\n\n"],[-1,"if($_GET['barcode'])\n{\n\t$barcode = new Barcode($scan['barcode']);\n\t$scanner = new Scanner();\n\t$errors = 1;\n\t\n\tif(!$event->exists())\n\t{\n\t\t$errors++;\n\t\t$error_message[$errors] = 'This event does not exist';\n\t\t$error_class_event_menu = 'error';\n\t}\n\t\n\tif(!$barcode->exists())\n\t{\n\t\t$errors++;\n\t\t$error_message[$errors] = 'The barcode <strong>#'.$barcode->code.'</strong> does not exist. Try scanning again.';\n\t\t$error_class_barcode = 'error';\n\t}\n\t\n\tif($scanner->exists($barcode->code, $scan['eid']))\n\t{\n\t\t$errors++;\n\t\t$form = '<form action=\"register.php\" method=\"GET\"><input type=\"text\" name=\"ucinetid\" placeholder=\"UCInetID\"><input type=\"submit\"></form>'; //todo associate barcode if the took one with out registering.\n\t\t$name = ($barcode->getName()) ? 'The user <strong>'.$barcode->getName().'</strong>':'The barcode <strong>#'.$barcode->code.'</strong>';\n\t\t$extra = ($barcode->getName()) ? 'Welcome.':'Please register this user\\'s UCInetID below: '.$form;\n\t\t$error_message[$errors] = $name.' has already been scanned. '.$extra;\n\t\t$error_class_barcode = 'error';\n\t}\n\t\t\n\tif($errors == 1)\n\t{\n\t\t$scanner->scan($barcode->code, $scan['eid'], $_SESSION['ucinetid']);\n\t\t$form = '<form action=\"register.php\" method=\"GET\"><input type=\"text\" name=\"ucinetid\" placeholder=\"UCInetID\"><input type=\"submit\"></form>'; //todo associate barcode if the took one with out registering.\n\t\t$name = ($barcode->getName()) ? 'The user <strong>'.$barcode->getName().'</strong>':'The barcode <strong>#'.$barcode->code.'</strong>';\n\t\t$extra = ($barcode->getName()) ? 'Welcome.':'Please register this user\\'s UCInetID below: '.$form;\n\t\t$message = $name.' has been scanned in'.$welcome;\n\t\t$page->setMessage($message, 'success');\n\t\t$js_slide_down = true;\n\t}\n\telse\n\t{\n\t\t$page->setMessage($error_message, 'failure');\n\t}\n}\n"],[0,"$sql"]],"start1":1363,"start2":1363,"length1":1793,"length2":8},{"diffs":[[0,"script>\n"],[1,"\n"],[0,"\t$(docum"]],"start1":4892,"start2":4892,"length1":16,"length2":17},{"diffs":[[0,"focus();"],[1,"\n\t\n\tvar code = $(\"#barcode\").val();\n\t$.ajax({\n      type: \"GET\",\n      url: \"scanner.php\",\n      data: { \n        eid: '.$scan['eid'].',\n        barcode: code,\n        ucinetid: '.$_SESSION['ucinetid'].'},\n      success: function(data) {\n        setMessage(data.message);\n        \n      }\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t"],[0,"';\nif($j"]],"start1":4950,"start2":4950,"length1":16,"length2":319}]],"length":8350,"saved":false}
{"ts":1378765859075,"patch":[[{"diffs":[[0,".message"],[1,", data.status"],[0,");\n     "]],"start1":5219,"start2":5219,"length1":16,"length2":29}]],"length":8363,"saved":false}
{"ts":1378765869996,"patch":[[{"diffs":[[0,"sage"],[1,".text"],[0,", data."],[1,"message."],[0,"stat"]],"start1":5223,"start2":5223,"length1":15,"length2":28}]],"length":8376,"saved":false}
{"ts":1378766536166,"patch":[[{"diffs":[[0,"orm "],[-1,"action=\"'.$_SERVER['PHP_SELF'].'"],[1,"id=\"barcode-form"],[0,"\" me"]],"start1":3746,"start2":3746,"length1":40,"length2":24},{"diffs":[[0,"s();\n\t\n\t"],[1,"$(\"#barcode-form\").submit(function() {\n\t    "],[0,"var code"]],"start1":4938,"start2":4938,"length1":16,"length2":60},{"diffs":[[0,".val();\n"],[1,"    "],[0,"\t$.ajax("]],"start1":5014,"start2":5014,"length1":16,"length2":20},{"diffs":[[0,"{\n      "],[1,"   "],[1," "],[0,"type: \"G"]],"start1":5034,"start2":5034,"length1":16,"length2":20},{"diffs":[[0," \"GET\",\n"],[1,"    "],[0,"      ur"]],"start1":5051,"start2":5051,"length1":16,"length2":20},{"diffs":[[0,",\n      "],[1,"  "],[1,"  "],[0,"data: { "]],"start1":5087,"start2":5087,"length1":16,"length2":20},{"diffs":[[0,"ata: { \n"],[1,"    "],[0,"        "]],"start1":5100,"start2":5100,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"    "],[0,"barcode:"]],"start1":5143,"start2":5143,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"   "],[1," "],[0,"ucinetid"]],"start1":5170,"start2":5170,"length1":16,"length2":20},{"diffs":[[0,",\n      "],[1,"    "],[0,"success:"]],"start1":5218,"start2":5218,"length1":16,"length2":20},{"diffs":[[0,"        "],[1," "],[1,"   "],[0,"setMessa"]],"start1":5256,"start2":5256,"length1":16,"length2":20},{"diffs":[[0,"    "],[-1,"\n      }"],[1,"    \n          }\n\t    });\n\t}\n\t"],[0,"\n\t\t\n"]],"start1":5324,"start2":5324,"length1":16,"length2":38}]],"length":8462,"saved":false}
{"ts":1378766552598,"patch":[[{"diffs":[[0,"    "],[-1,"  \n          }\n\t    });\n\t}\n\t\n\t\t\n\t\t\n\t\t\n\t\t\n\t\t"],[1,"}\n\t    });\n\t}"],[0,"';\ni"]],"start1":5326,"start2":5326,"length1":51,"length2":21}]],"length":8432,"saved":false}
{"ts":1378766672330,"patch":[[{"diffs":[[0,"    });\n"],[1,"\t    return false;\n"],[0,"\t}';\nif("]],"start1":5333,"start2":5333,"length1":16,"length2":35}]],"length":8451,"saved":false}
{"ts":1378766762161,"patch":[[{"diffs":[[0,"unction("],[-1,") {"],[1,"event) {\n\t    event.preventDefault()"],[0,"\n\t    va"]],"start1":4973,"start2":4973,"length1":19,"length2":52}]],"length":8484,"saved":false}
{"ts":1378766817848,"patch":[[{"diffs":[[0,"efault()"],[1,";"],[0,"\n\t    va"]],"start1":5009,"start2":5009,"length1":16,"length2":17}]],"length":8485,"saved":false}
{"ts":1378767194307,"patch":[[{"diffs":[[0,"\" name=\""],[-1,"actio"],[1,"sca"],[0,"n\" value"]],"start1":4022,"start2":4022,"length1":21,"length2":19},{"diffs":[[0,");\n\t"],[1,"\t"],[0,"\n\t$("],[-1,"\""],[1,"function() { //shorthand document.ready function\n    $('"],[0,"#bar"]],"start1":4938,"start2":4938,"length1":13,"length2":69},{"diffs":[[0,"ode-form"],[-1,"\""],[1,"'"],[0,")."],[1,"on('"],[0,"submit"],[-1,"("],[1,"', "],[0,"function"]],"start1":5008,"start2":5008,"length1":26,"length2":32},{"diffs":[[0,"on(e"],[-1,"vent) {\n\t    event.preventDefault();\n\t"],[1,") { //use on if jQuery 1.7+\n        e.preventDefault();  //prevent form from submitting\n    "],[0,"    "]],"start1":5038,"start2":5038,"length1":46,"length2":100},{"diffs":[[0,"    "],[-1,"}\n\t    });"],[1,"  console.log(data); //use the console for debugging, F12 in Chrome, not alerts\n          }\n\t    });\n    });\n});\n\t\n\t$(\"#barcode-form\").submit(function(event) {\n\t    event.preventDefault();\n\t    "],[0,"\n\t  "]],"start1":5474,"start2":5474,"length1":18,"length2":202}]],"length":8783,"saved":false}
{"ts":1378767211122,"patch":[[{"diffs":[[0,"e) {"],[-1," //use on if jQuery 1.7+"],[0,"\n   "]],"start1":5041,"start2":5041,"length1":32,"length2":8}]],"length":8759,"saved":false}
{"ts":1378767231774,"patch":[[{"diffs":[[0,"n\n    $("],[-1,"'"],[1,"\""],[0,"#barcode"]],"start1":4994,"start2":4994,"length1":17,"length2":17},{"diffs":[[0,"form"],[-1,"'"],[1,"\""],[0,").on("],[-1,"'"],[1,"\""],[0,"submit"],[-1,"'"],[1,"\""],[0,", fu"]],"start1":5012,"start2":5012,"length1":22,"length2":22}]],"length":8759,"saved":false}
{"ts":1378767306803,"patch":[[{"diffs":[[0,"n() "],[-1,"{ //shorthand document.ready function\n"],[1,"\n\t{\n    "],[0,"    "]],"start1":4954,"start2":4954,"length1":46,"length2":16},{"diffs":[[0,"tion(e) "],[-1,"{"],[0,"\n"],[1,"        {\n    "],[0,"        "]],"start1":5006,"start2":5006,"length1":18,"length2":31},{"diffs":[[0,"        "],[1,"    "],[0,"var code"]],"start1":5089,"start2":5089,"length1":16,"length2":20},{"diffs":[[0,"();\n    "],[1,"   "],[1," "],[0,"\t$.ajax("]],"start1":5129,"start2":5129,"length1":16,"length2":20},{"diffs":[[0,".ajax({\n"],[1,"    "],[0,"        "]],"start1":5143,"start2":5143,"length1":16,"length2":20},{"diffs":[[0,"        "],[1," "],[1,"   "],[0,"url: \"sc"]],"start1":5180,"start2":5180,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"   "],[1," "],[0,"data: { "]],"start1":5214,"start2":5214,"length1":16,"length2":20},{"diffs":[[0,"ata: { \n"],[1,"    "],[0,"        "]],"start1":5227,"start2":5227,"length1":16,"length2":20},{"diffs":[[0,"        "],[1," "],[1,"   "],[0,"barcode:"]],"start1":5278,"start2":5278,"length1":16,"length2":20},{"diffs":[[0,": code,\n"],[1,"    "],[0,"        "]],"start1":5297,"start2":5297,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"    "],[0,"success:"]],"start1":5361,"start2":5361,"length1":16,"length2":20},{"diffs":[[0,"        "],[1,"  "],[1,"  "],[0,"setMessa"]],"start1":5403,"start2":5403,"length1":16,"length2":20},{"diffs":[[0,"tatus);\n"],[1,"    "],[0,"        "]],"start1":5459,"start2":5459,"length1":16,"length2":20},{"diffs":[[0,"    "],[-1,"}\n\t"],[0,"    }"],[-1,");"],[0,"\n    "],[-1,"});\n});\n\t\n\t$(\"#barcode-form\").submit(function(event) {\n\t    event.preventDefault("],[1,"\t    }"],[0,");\n"],[-1,"\t"],[0,"    "],[-1,"\n\t"],[0,"    "],[-1,"return false;\n\t}"],[1,"});\n    });"],[0,"';\ni"]],"start1":5567,"start2":5567,"length1":134,"length2":46}]],"length":8698,"saved":false}
{"ts":1378767310177,"patch":[[{"diffs":[[0,"  });';\n"],[1,"    \n"],[0,"if($js_s"]],"start1":5604,"start2":5604,"length1":16,"length2":21}]],"length":8703,"saved":false}
{"ts":1378767366390,"patch":[[{"diffs":[[0,"inetid: "],[1,"\""],[0,"'.$_SESS"]],"start1":5323,"start2":5323,"length1":16,"length2":17},{"diffs":[[0,"etid'].'"],[1,"\""],[0,"},\n     "]],"start1":5349,"start2":5349,"length1":16,"length2":17}]],"length":8705,"saved":false}
{"ts":1378767400165,"patch":[[{"diffs":[[0,"data) {\n"],[1,"              \n                console.log(data); \n"],[0,"        "]],"start1":5393,"start2":5393,"length1":16,"length2":67},{"diffs":[[0,"s);\n"],[-1,"                console.log(data); //use the console for debugging, F12 in Chrome, not alerts\n"],[0,"    "]],"start1":5516,"start2":5516,"length1":102,"length2":8}]],"length":8662,"saved":false}
{"ts":1378767489295,"patch":[[{"diffs":[[0,"r.php\",\n"],[1,"              dataType: \"json\",\n"],[0,"        "]],"start1":5204,"start2":5204,"length1":16,"length2":48},{"diffs":[[0,"sage"],[-1,"."],[1,"["],[0,"text"],[1,"]"],[0,", da"]],"start1":5519,"start2":5519,"length1":13,"length2":14}]],"length":8695,"saved":false}
{"ts":1378767525557,"patch":[[{"diffs":[[0,"sage"],[-1,"["],[1,"."],[0,"text"],[-1,"]"],[0,", da"]],"start1":5519,"start2":5519,"length1":14,"length2":13}]],"length":8694,"saved":false}
{"ts":1378767702981,"patch":[[{"diffs":[[0,") {\n"],[-1,"              \n"],[0,"    "]],"start1":5429,"start2":5429,"length1":23,"length2":8},{"diffs":[[0,"}\n    \t    }"],[1,"\n    \t    $(\"#barcode\").val(\"\");\n    \t    $(\"#barcode\").focus();\n    \t    "],[0,");\n        }"]],"start1":5551,"start2":5551,"length1":24,"length2":98}]],"length":8753,"saved":false}
{"ts":1378767745831,"patch":[[{"diffs":[[0,"\").val(\""],[1," "],[0,"\");\n    "]],"start1":5584,"start2":5584,"length1":16,"length2":17}]],"length":8754,"saved":false}
{"ts":1378767763727,"patch":[[{"diffs":[[0,"}\n    \t    }"],[1,");"],[0,"\n    \t    $("]],"start1":5551,"start2":5551,"length1":24,"length2":26},{"diffs":[[0,"();\n"],[-1,"    \t    );\n"],[0,"    "]],"start1":5627,"start2":5627,"length1":20,"length2":8}]],"length":8744,"saved":false}
{"ts":1378770635951,"patch":[[{"diffs":[[0,"div "],[-1,"class=\"row center\">\n\t\t\t\t\t\t<h3>Scan Ticker</h3>\n\t\t\t\t\t</div>';\n\t\t\t\t\t\n$ticker_content .= '<div class=\"list\">';\n\n/* Start doing the JavaScript \n *\n */\n \n//set initial javascript\nif($js_slide_down)\n\t$js_hide_row1 = '$(\"#row1\").hide();';\n$page->setJSInitial('$(\".dropdown\").hide(); '.$js_hide_row1);"],[1,"id=\"ticker\" class=\"ticker\"></div>'\n\n/* Start doing the JavaScript \n *\n */\n "],[0,"\n\t\n/"]],"start1":4516,"start2":4516,"length1":301,"length2":83},{"diffs":[[0,"   \n"],[-1,"if($js_slide_down)\n $ticker_content .= '$(\"#row1\").slideDown();';\n\n$ticker_content .= '});</script>';\n\t\nif(count($ticker_array) > 0)\n{\n\t\n\tforeach ($ticker_array as $row)\n\t{\n\t\t$i++;\n\t\t\n\t\t$ticker_content .= '\n\t\t\t<div class=\"item\" id=\"row'.$i.'\">\n\t\t\t\t<div class=\"row\">\n\t\t\t\t\t<label class=\"barcode\">Barcode: </span> #'.$row['barcode'].'</label>\n\t\t\t\t\t<span class=\"right\">'.$row['name'].'</span>\n\t\t\t\t\t<span class=\"date\">'.date('M j,', strtotime($row['date'])).'</span>\n\t\t\t\t\t<span class=\"time\">'.date('g:i:s A', strtotime($row['time'])).'</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"event_row\">\n\t\t\t\t<script>\n\t\t\t\t    $(\"#row'.$i.'\").click(function () {\n\t\t\t\t    \t$(\"#drop'.$i.'\").slideToggle(\"fast\");\n\t\t\t\t    });\n\t\t\t\t</script>\n\t\t\t\t<div class=\"dropdown\" id=\"drop'.$i.'\" style=\"display:none;\">\n\t\t\t\t\t<h5><strong>UCInetID:</strong> \t'.$row['ucinetid'].'</h5>\n\t\t\t\t\t<h5><strong>Name:</strong> \t\t'.$row['name'].'</h5>\n\t\t\t\t\t<h5><strong>Major:</strong> \t'.$row['major'].'</h5>\n\t\t\t\t\t<h5><strong>Level:</strong> \t'.$row['level'].'</h5>\n\t\t\t\t\t<h5><strong>Time:</strong>\t\t'.date('M j, Y,', strtotime($row['date'])).' '.date('g:i:s A', strtotime($row['time'])).'</h5>\n\t\t\t\t</div>\n\t\t\t</div>';\n\t}\n\t\n\t//view all link at the bottom of page\n\tif($_GET['view'] == 'all')\n\t{\n\t$ticker_content .= '\n\t\t<div class=\"row center\">\n\t\t<label id=\"view\"><a href=\"'.$_SERVER['PHP_SELF'].'?view=less#view\">View Less Scans</a></label>\n\t\t</div>';\n\t}\n\telse \n\t{\n\t$ticker_content .= '\n\t\t<div class=\"row center\">\n\t\t<label id=\"view\"><a href=\"'.$_SERVER['PHP_SELF'].'?view=all#view\">View All Scans</a></label>\n\t\t</div>';\n\t}\n}\nelse {\n\t$ticker_content .= '\n\t<div class=\"list\">\n\t<div class=\"row\">\n\t\t<label>No Scans Yet</label>\n\t</div>\n\t</div>';\n}\n$ticker_content .= '</div>';"],[0,"\n\n\n/"]],"start1":5436,"start2":5436,"length1":1724,"length2":8}]],"length":6810,"saved":false}
{"ts":1378770690562,"patch":[[{"diffs":[[0,"tatus);\n"],[1,"                appendbarcode(data.scans);\n"],[0,"        "]],"start1":5311,"start2":5311,"length1":16,"length2":59}]],"length":6853,"saved":false}
{"ts":1378770721465,"patch":[[{"diffs":[[0,"    "],[-1,"  appendb"],[1,"}\n    \t    });\n    \t    $.ajax({\n              type: \"GET\",\n              url: \"ticker.php\",\n              dataType: \"json\",\n              data: { \n                eid: '.$scan['eid'].',\n                barcode: code,\n                ucinetid: \"'.$_SESSION['ucinetid'].'\"},\n              success: function(data) {\n                console.log(data); \n                appendB"],[0,"arco"]],"start1":5329,"start2":5329,"length1":17,"length2":381}]],"length":7217,"saved":false}
{"ts":1378770741844,"patch":[[{"diffs":[[0,"'].'"],[-1,",\n                barcode: code,\n                ucinetid: \"'.$_SESSION['ucinetid'].'\"},"],[1,"}"],[0,"\n   "]],"start1":5514,"start2":5514,"length1":96,"length2":9}]],"length":7130,"saved":false}
{"ts":1378770809807,"patch":[[{"diffs":[[0,"></div>'"],[1,";"],[0,"\n\n/* Sta"]],"start1":4546,"start2":4546,"length1":16,"length2":17}]],"length":7131,"saved":false}
{"ts":1378770898171,"patch":[[{"diffs":[[0,"\n *\n */\n"],[-1," \n"],[0,"\t\n//set "]],"start1":4587,"start2":4587,"length1":18,"length2":16}]],"length":7129,"saved":false}
{"ts":1378770922662,"patch":[[{"diffs":[[0,"eid'].'}"],[1,","],[0,"\n       "]],"start1":5510,"start2":5510,"length1":16,"length2":17}]],"length":7130,"saved":false}
{"ts":1378770970621,"patch":[[{"diffs":[[0,";';\n"],[-1,"    \n\n\n"],[0,"\n/*\n"]],"start1":5751,"start2":5751,"length1":15,"length2":8}]],"length":7123,"saved":false}
{"ts":1378771074249,"patch":[[{"diffs":[[0,"\n    });"],[1,"\n    </script>"],[0,"';\n\n/*\n "]],"start1":5744,"start2":5744,"length1":16,"length2":30}]],"length":7137,"saved":false}
{"ts":1378771177102,"patch":[[{"diffs":[[0,"});\n    });\n"],[1,"    );\n"],[0,"    </script"]],"start1":5741,"start2":5741,"length1":24,"length2":31}]],"length":7144,"saved":false}
{"ts":1378771203939,"patch":[[{"diffs":[[0,"});\n"],[-1,"    );\n"],[0,"    "]],"start1":5749,"start2":5749,"length1":15,"length2":8}]],"length":7137,"saved":false}
{"contributors":[],"silentsave":false,"ts":1378943520041,"patch":[[{"diffs":[[0,"\n */"],[-1,"\n$js_slide_down = false;"],[0,"\n\n$e"]],"start1":1094,"start2":1094,"length1":32,"length2":8},{"diffs":[[0,"ent .= '"],[1,"\n\n"],[0,"<script>"]],"start1":4622,"start2":4622,"length1":16,"length2":18},{"diffs":[[0,";\n\t\t"],[-1,"\n\t$(function() \n\t{\n    "],[1,"loadTicker('.$scan['eid'].');\n\t});\n\t\n"],[0,"    "]],"start1":4698,"start2":4698,"length1":31,"length2":45},{"diffs":[[0,"(e) "],[1,"{"],[0,"\n"],[-1,"        {\n    "],[0,"    "]],"start1":4783,"start2":4783,"length1":23,"length2":10},{"diffs":[[0,"        "],[-1,"    "],[0,"var code"]],"start1":4849,"start2":4849,"length1":20,"length2":16},{"diffs":[[0,"de\").val();\n"],[-1,"    "],[0,"    \t$.ajax("]],"start1":4877,"start2":4877,"length1":28,"length2":24},{"diffs":[[0,"jax({\n          "],[-1,"    "],[0,"type: \"GET\",\n   "]],"start1":4897,"start2":4897,"length1":36,"length2":32},{"diffs":[[0,",\n          "],[-1,"   "],[-1," "],[0,"url: \"scanne"]],"start1":4924,"start2":4924,"length1":28,"length2":24},{"diffs":[[0,"php\",\n          "],[-1,"    "],[0,"dataType: \"json\""]],"start1":4950,"start2":4950,"length1":36,"length2":32},{"diffs":[[0,"son\",\n          "],[-1,"   "],[-1," "],[0,"data: { \n       "]],"start1":4978,"start2":4978,"length1":36,"length2":32},{"diffs":[[0,"       data: { \n"],[-1,"    "],[0,"            eid:"]],"start1":4987,"start2":4987,"length1":36,"length2":32},{"diffs":[[0,"        "],[-1,"  "],[-1,"  "],[0,"barcode:"]],"start1":5042,"start2":5042,"length1":20,"length2":16},{"diffs":[[0,": code,\n"],[-1,"    "],[0,"        "]],"start1":5057,"start2":5057,"length1":20,"length2":16},{"diffs":[[0,".'\"},\n          "],[-1,"  "],[-1,"  "],[0,"success: functio"]],"start1":5111,"start2":5111,"length1":36,"length2":32},{"diffs":[[0,"    "],[-1,"    console.log(data); \n                setMessage(data.message.text, data.message.status);"],[1,"if(data.message.status == \"success\")"],[0,"\n   "]],"start1":5161,"start2":5161,"length1":99,"length2":44},{"diffs":[[0,"    "],[-1,"  }"],[1,"{"],[0,"\n    "],[-1,"\t"],[0,"    "],[-1,"});\n"],[0,"    "],[-1,"\t"],[0,"    "],[-1,"$.ajax({\n              type: \"GET\",\n              url: \"ticker.php\",\n              dataType: \"json\",\n              data: { \n                eid: '.$scan['eid'].'},\n              success: function(data) {\n                console.log(data); \n                appendBarcode(data.scan"],[1,"appendBarcode(data.scan[0]);\n            }\n            setMessage(data.message.text, data.message.statu"],[0,"s);\n"]],"start1":5210,"start2":5210,"length1":313,"length2":129},{"diffs":[[0,"        "],[-1,"   "],[-1," "],[0,"}\n"],[-1,"    "],[0,"\t    });"]],"start1":5341,"start2":5341,"length1":26,"length2":18},{"diffs":[[0,"    });\n"],[-1,"    "],[0,"\t    $(\""]],"start1":5352,"start2":5352,"length1":20,"length2":16},{"diffs":[[0,"l(\" \");\n"],[-1,"    "],[0,"\t    $(\""]],"start1":5381,"start2":5381,"length1":20,"length2":16},{"diffs":[[0,"ocus();\n"],[-1,"    "],[1,"\t"],[0,"    "],[-1,"});"],[0,"\n    });"]],"start1":5409,"start2":5409,"length1":27,"length2":21}]],"length":6815,"saved":false}
{"ts":1378943590008,"patch":[[{"diffs":[[0,"];\n\n"],[-1,"/* make sure the slide animation does not trigger, \n * may confuse Volunteer who is scanning that a scan went through\n * when there was really an error.\n */\n\n"],[0,"$eve"]],"start1":938,"start2":938,"length1":166,"length2":8},{"diffs":[[0,"cker_content"],[1,"s"],[0," .= '\n\n<scri"]],"start1":4455,"start2":4455,"length1":24,"length2":25}]],"length":6658,"saved":false}
{"ts":1378943663280,"patch":[[{"diffs":[[0,"_content"],[-1,"s"],[0," .= '\n\n<"]],"start1":4459,"start2":4459,"length1":17,"length2":16}]],"length":6657,"saved":false}
{"ts":1378943693170,"patch":[[{"diffs":[[0,"cker_content"],[1,"d"],[0," .= '\n\n<scri"]],"start1":4455,"start2":4455,"length1":24,"length2":25}]],"length":6658,"saved":false}
