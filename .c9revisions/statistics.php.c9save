{"ts":1378943469973,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\nrequire_once 'inc/standard.php';\n\n//$page = new Page($name, $css);\n$page = new Page('statistics', ALL);\n$page->setTitle('Statistics');\n$page->startGraph();\n//adds the jQuery Sparkline to the header\n\n$var_array = new VarArray();\n \n /* User Statistics \n  * \n  */\nforeach($var_array->getAccess() as $key => $value)\n{\n\t//echo $key.' => '.$value;\n\t$access[$value] = $page->DB->countOf('users', 'access = \"'.$key.'\"');\n}\n\n$access_stat = new Statistic('pie', 'user_access', 'Registered Users - Access', $access, 6); //play with this number to change up the colors\n\n/*end Major Statistics*/\t\n \n /*\n  * Major Statistics\n  */\nforeach ($var_array->getMajors() as $major) {\n\t$where .= 'major NOT LIKE \\''.$major.'\\' AND ';\n\tif($major != \"Other\")\n\t{\n\t\t$majors[$major] = $page->DB->countOf('users', 'major = \"'.$major.'\"');\n\t}\n\telse\n\t{\n\t\t$where = substr($where, 0, strlen($where)-5);\n\t\t//echo \"where: \".$where;\n\t\t//$majors[\"other\"] = $page->DB->countOf('users', $where_majors_not_like, 1);\n\t\t$majors[\"Other\"] = $page->DB->countOf('users', $where);\n\t}\n}\n\n$majors_stat = new Statistic('pie', 'user_majors', 'Registered Users - Major', $majors, 0);//play with this number to change up the colors\n\n/*end Major Statistics*/\t\n\n\n/*\n * Levels Statistics\n */\nforeach ($var_array->getLevels() as $level) {\n\t$levels[$level] = $page->DB->countOf('users', 'level = \"'.$level.'\"');\n}\n\n$levels_stat = new Statistic('pie', 'user_levels', 'Registered Users - Level', $levels, 2);//play with this number to change up the colors\n\n/* end Levels Statistic */\n\n/*\n * Events Statistics\n */\nforeach ($var_array->getDates() as $key => $value) {\n\t$new_key = date('n/d',strtotime($key));\n\t$events[$new_key] = $page->DB->countOf('events', 'date = \"'.$key.'\"');\n\t//echo 'date = \"'.$key.'\" - '.$events[$new_key].'<br>';\n}\n\n$events_stat = new Statistic('bar', 'events_stat', 'Number of Events on Each Day', $events, 2);//play with this number to change up the colors\n\n/* end Events Statistic */\n\n/*\n * Events Statistics\n */\nforeach ($var_array->getDates(false, true) as $key => $value) {\n\t$new_key = date('n/d',strtotime($key));\n\t$sql = 'SELECT COUNT(*)\n\t\t\tFROM scans\n\t\t\tLEFT JOIN events \n\t\t\tON scans.eid = events.eid\n\t\t\tWHERE events.date LIKE \"'.$key.'\"';\n\t$scans[$new_key] = $page->DB->queryUniqueValue($sql);\n\t//echo 'date = \"'.$key.'\"';\n}\n\n$participation_stat = new Statistic('bar', 'scans_week', 'Participation on Each Day', $scans, 7);//play with this number to change up the colors\n\n/* end Events Statistic */\n\n\n$bottom .= $access_stat->display();\n$bottom .= '<div class=\"separator\"></div>';\n$bottom .= $majors_stat->display();\n$bottom .= '<div class=\"separator\"></div>';\n$bottom .= $levels_stat->display();\n$bottom .= '<div class=\"separator\"></div>';\n$bottom .= $events_stat->display();\n$bottom .= '<div class=\"separator\"></div>';\n$bottom .= $participation_stat->display();\n\n\n/*\n$bottom .= '<div id=\"chart\"></div>\n\t\t\t<script src=\"javascript/chart.js\"></script>';\n\t\t\t\n*/\n\n$box = new Box('Statistics', $bottom);\n\n$content = $box->display('full');\n\n$page->setContent($content);\n$page->buildPage();\n?>"]],"start1":0,"start2":0,"length1":0,"length2":3066}]],"length":3066}
